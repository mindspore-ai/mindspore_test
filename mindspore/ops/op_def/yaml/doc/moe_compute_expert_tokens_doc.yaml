moe_compute_expert_tokens:
  description: |
    In MoE calculation, Search for the last index processed by each expert through binary search.

    .. math::
        expertTokens_{i} = BinarySearch(SortedExperts, numExeprt)

    Inputs:
        SortedExperts (Tensor) : A tensor which represent sorted experts, must be 1D tensor. Supported type: Int32.
        numExeprt (int): The number of experts, must be greater than 0.

    Outputs:
        Tensor, have the same dtype with SortedExperts.

    Raises:
        TypeError: if `SortedExperts` is not a tensor.
        ValueError: if `numExeprt` is less than 0.

    Supported Platforms:
        ``Ascend``

    Examples:
        >>> import mindspore as ms
        >>> from mindspore.ops.auto_generate import MoeComputeExpertTokens
        >>> sorted_experts = ms.Tensor([0, 0, 1, 2, 2], dtype=ms.int32)
        >>> num_exprt = 5
        >>> net = MoeComputeExpertTokens()
        >>> expert_tokens = net(sorted_experts, num_exprt)
        >>> print(expert_tokens)
        [2, 3, 5]