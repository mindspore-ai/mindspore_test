diff -Npur ffmpeg-5.1.4/libavformat/sbgdec.c ffmpeg-5.1.4-change/libavformat/sbgdec.c
--- ffmpeg-5.1.4/libavformat/sbgdec.c	2023-11-10 07:38:54.000000000 +0800
+++ ffmpeg-5.1.4-change/libavformat/sbgdec.c	2024-12-09 11:45:52.338969266 +0800
@@ -385,7 +385,7 @@ static int parse_options(struct sbg_pars
                 case 'L':
                     FORWARD_ERROR(parse_optarg(p, opt, &oarg));
                     r = str_to_time(oarg.s, &p->scs.opt_duration);
-                    if (oarg.e != oarg.s + r) {
+                    if (oarg.e != oarg.s + r || p->scs.opt_duration < 0) {
                         snprintf(p->err_msg, sizeof(p->err_msg),
                                  "syntax error for option -L");
                         return AVERROR_INVALIDDATA;
