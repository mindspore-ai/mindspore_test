diff -Npur ffmpeg-5.1.2/libavcodec/pnmdec.c ffmpeg-5.1.2-change/libavcodec/pnmdec.c
--- ffmpeg-5.1.2/libavcodec/pnmdec.c	2022-07-23 01:58:39.000000000 +0800
+++ ffmpeg-5.1.2-change/libavcodec/pnmdec.c	2025-06-05 10:46:15.000003128 +0800
@@ -260,7 +260,7 @@ static int pnm_decode_frame(AVCodecConte
         break;
     case AV_PIX_FMT_GBRPF32:
         if (!s->half) {
-        if (avctx->width * avctx->height * 12 > s->bytestream_end - s->bytestream)
+        if (avctx->width * avctx->height * 12LL > s->bytestream_end - s->bytestream)
             return AVERROR_INVALIDDATA;
         scale = 1.f / s->scale;
         if (s->endian) {
