diff -Npur ffmpeg-5.1.4/libavformat/cafdec.c ffmpeg-5.1.4-change/libavformat/cafdec.c
--- ffmpeg-5.1.4/libavformat/cafdec.c	2023-11-10 07:38:51.000000000 +0800
+++ ffmpeg-5.1.4-change/libavformat/cafdec.c	2024-12-09 15:58:13.290169894 +0800
@@ -265,7 +265,7 @@ static int read_pakt_chunk(AVFormatConte
         }
     }
 
-    if (avio_tell(pb) - ccount > size) {
+    if (avio_tell(pb) - ccount > size || size > INT64_MAX - ccount) {
         av_log(s, AV_LOG_ERROR, "error reading packet table\n");
         return AVERROR_INVALIDDATA;
     }
