diff -Npur ffmpeg-5.1.2/libavformat/cafdec.c ffmpeg-5.1.2-change/libavformat/cafdec.c
--- ffmpeg-5.1.2/libavformat/cafdec.c	2022-09-25 17:46:07.000000000 +0800
+++ ffmpeg-5.1.2-change/libavformat/cafdec.c	2024-12-14 16:38:36.193334415 +0800
@@ -265,7 +265,7 @@ static int read_pakt_chunk(AVFormatConte
         }
     }
 
-    if (avio_tell(pb) - ccount > size) {
+    if (avio_tell(pb) - ccount > size || size > INT64_MAX - ccount) {
         av_log(s, AV_LOG_ERROR, "error reading packet table\n");
         return AVERROR_INVALIDDATA;
     }
