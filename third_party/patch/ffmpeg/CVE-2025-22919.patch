diff -Npur ffmpeg-5.1.4/libavfilter/buffersrc.c ffmpeg-5.1.4-change/libavfilter/buffersrc.c
--- ffmpeg-5.1.4/libavfilter/buffersrc.c	2023-11-10 07:38:51.000000000 +0800
+++ ffmpeg-5.1.4-change/libavfilter/buffersrc.c	2025-02-28 15:47:02.697795469 +0800
@@ -382,6 +382,11 @@ FF_ENABLE_DEPRECATION_WARNINGS
         av_channel_layout_describe(&s->ch_layout, buf, sizeof(buf));
     }
 
+    if (s->sample_rate <= 0) {
+        av_log(ctx, AV_LOG_ERROR, "Sample rate not set\n");
+        return AVERROR(EINVAL);
+    }
+
     if (!s->time_base.num)
         s->time_base = (AVRational){1, s->sample_rate};
 

